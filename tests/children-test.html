<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Тест: Сколько у меня будет детей? - BPD tests</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@700;900&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        background: #0a0a0a;
        color: #ffffff;
        overflow-x: hidden;
      }

      .display-font {
        font-family: "Playfair Display", serif;
      }

      .dynamic-bg {
        position: fixed;
        inset: 0;
        background: #0a0a0a;
        overflow: hidden;
      }

      .dynamic-bg::before {
        content: "";
        position: absolute;
        width: 150%;
        height: 150%;
        top: -25%;
        left: -25%;
        background: radial-gradient(
            circle at 25% 25%,
            rgba(59, 130, 246, 0.1) 0%,
            transparent 40%
          ),
          radial-gradient(
            circle at 75% 75%,
            rgba(16, 185, 129, 0.1) 0%,
            transparent 40%
          ),
          radial-gradient(
            circle at 50% 50%,
            rgba(236, 72, 153, 0.05) 0%,
            transparent 60%
          );
      }

      .glass-panel {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(25px) saturate(150%);
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
      }

      a,
      .transition-colors {
        transition: color 0.4s ease;
      }

      .transition-transform {
        transition: transform 0.4s ease;
      }

      .option-card,
      .btn-premium {
        /* Performance hint for the browser */
        will-change: transform, background, border-color;
      }

      .option-card {
        background: rgba(255, 255, 255, 0.03);
        border: 2px solid rgba(255, 255, 255, 0.1);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .option-card:hover {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(59, 130, 246, 0.5);
        transform: translateY(-2px);
      }

      .option-card.selected {
        background: linear-gradient(
          135deg,
          rgba(59, 130, 246, 0.2),
          rgba(16, 185, 129, 0.2)
        );
        border-color: rgba(59, 130, 246, 0.6);
      }

      input[type="radio"] {
        display: none;
      }

      .btn-premium {
        position: relative;
        background: linear-gradient(135deg, #3b82f6 0%, #10b981 100%);
        color: white;
        padding: 20px 60px;
        border-radius: 16px;
        font-weight: 700;
        font-size: 18px;
        transition: all 0.4s ease;
      }

      .progress-container {
        position: sticky;
        top: 80px;
        z-index: 40;
        padding: 1rem 0;
        background: rgba(10, 10, 10, 0.7);
        backdrop-filter: blur(8px);
        margin-bottom: 2rem;
        border-radius: 1rem;
      }

      .progress-bar {
        height: 6px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
        overflow: hidden;
        width: 90%;
        margin: 0 auto;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #3b82f6, #10b981);
        border-radius: 3px;
        transition: width 0.5s ease;
      }

      .gradient-text {
        background: linear-gradient(
          135deg,
          #3b82f6 0%,
          #10b981 50%,
          #f59e0b 100%
        );
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        background-size: 200% 200%;
        animation: gradient-shift 3s ease infinite;
      }

      @keyframes gradient-shift {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      .fade-in {
        animation: fadeIn 0.5s ease-out;
      }

      .fade-out {
        animation: fadeOut 0.5s ease-in forwards;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeOut {
        from {
          opacity: 1;
          transform: translateY(0);
        }
        to {
          opacity: 0;
          transform: translateY(-20px);
          visibility: hidden;
        }
      }

      .timeline-item {
        opacity: 0;
        transform: translateY(20px);
        animation: fadeIn 0.5s ease-out forwards;
      }

      /* --- Mobile Optimizations --- */
      @media (max-width: 768px) {
        .glass-panel,
        .progress-container {
          /* Remove the most expensive properties on mobile */
          backdrop-filter: none;
          background: rgba(
            20,
            20,
            22,
            0.85
          ); /* Use a solid background instead */
          border-color: rgba(255, 255, 255, 0.15);
        }

        .dynamic-bg {
          display: none; /* Disable the animated background on mobile */
        }
      }
    </style>
  </head>
  <body>
    <div class="dynamic-bg"></div>

    <div class="relative z-10 min-h-screen flex flex-col">
      <!-- Navigation -->
      <nav class="glass-panel fixed top-0 w-full z-50 px-6 py-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
          <a href="../../index.html" class="flex items-center space-x-2 group">
            <div
              class="w-10 h-10 rounded-lg bg-gradient-to-br from-sky-500 to-green-500 flex items-center justify-center group-hover:scale-110 transition-transform"
            >
              <span class="text-white font-bold text-xl">Ψ</span>
            </div>
            <span class="text-xl font-semibold">BPD tests</span>
          </a>
          <div class="flex items-center space-x-6">
            <a href="../../index.html" class="hover:text-purple-400"
              >← Вернуться к тестам</a
            >
          </div>
        </div>
      </nav>

      <!-- Main Content -->
      <div
        class="container mx-auto max-w-5xl px-4 sm:px-6 md:px-8 pt-24 pb-20 flex-grow"
      >
        <!-- Test Header -->
        <header class="text-center mb-12 fade-in" style="margin-top: 80px">
          <h1
            class="display-font text-5xl sm:text-6xl md:text-7xl font-bold mb-4"
          >
            Тест: <span class="gradient-text">Сколько у меня будет детей?</span>
          </h1>
          <p class="text-center text-gray-500 -mt-4 mb-8">
            Анализ основан на вашем поведении и ощущениях за последние 2 недели.
          </p>
        </header>

        <!-- Test Container -->
        <main id="test-container" class="fade-in">
          <!-- Progress Bar Container -->
          <div class="progress-container" id="progress-container">
            <div class="progress-bar" id="progress-bar">
              <div
                class="progress-fill"
                id="progress-fill"
                style="width: 0%"
              ></div>
            </div>
          </div>

          <form
            id="children-test-form"
            class="glass-panel rounded-3xl p-8 md:p-12 shadow-2xl space-y-10"
          ></form>

          <div class="mt-16 text-center">
            <button type="submit" form="children-test-form" class="btn-premium">
              <span class="relative z-10">Узнать своё будущее</span>
            </button>
          </div>
        </main>

        <!-- Results Container -->
        <div id="results-container" class="hidden mt-16">
          <div
            class="glass-panel rounded-3xl p-8 md:p-12 shadow-2xl text-center"
          >
            <h2
              class="display-font text-4xl md:text-5xl font-bold mb-4"
              id="result-title"
            ></h2>
            <p
              id="result-description"
              class="text-gray-300 text-lg leading-relaxed max-w-3xl mx-auto mb-12"
            ></p>

            <div
              id="timeline-container"
              class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center"
            >
              <!-- Timeline items will be injected here -->
            </div>
          </div>

          <div class="mt-12 text-center space-y-4">
            <button onclick="location.reload()" class="btn-premium">
              Пройти тест заново
            </button>
            <div>
              <a
                href="../../index.html"
                class="text-purple-400 hover:text-purple-300"
              >
                Вернуться к списку тестов →
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="glass-panel mt-auto py-8 px-6">
        <div class="max-w-7xl mx-auto">
          <div class="flex flex-col md:flex-row justify-between items-center">
            <div class="text-center md:text-left mb-4 md:mb-0">
              <p class="text-gray-400">© 2025 BPD tests. Все права защищены.</p>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
    <script>
      const questions = [
        {
          q: "Мысль о том, что кто-то будет называть тебя 'родитель', вызывает у тебя...",
          a: "emotion",
        },
        {
          q: "Готов(а) ли ты променять спонтанные вылазки с друзьями на вечер с детскими сказками?",
          a: "sacrifice",
        },
        {
          q: "Видишь ли ты себя человеком, который сможет собрать детскую мебель, не сойдя с ума?",
          a: "skills",
        },
        {
          q: "Тебя умиляют детские рисунки, даже если это просто каляка-маляка?",
          a: "reaction",
        },
        {
          q: "Готов(а) ли ты к тому, что бюджет на хобби превратится в бюджет на подгузники?",
          a: "finance",
        },
        {
          q: "Идея провести выходные в детском парке развлечений кажется тебе...",
          a: "weekend",
        },
        {
          q: "Спокойно ли ты относишься к детскому плачу в общественных местах?",
          a: "patience",
        },
        {
          q: "Считаешь ли ты, что уход за ребенком - это общая обязанность партнеров?",
          a: "duty",
        },
        {
          q: "Готов(а) ли ты делить свое личное пространство с кучей игрушек?",
          a: "space",
        },
        {
          q: "Мысль о родительских собраниях вгоняет тебя в тоску?",
          a: "meetings",
        },
        {
          q: "Считаешь ли ты свое терпение 'ангельским'?",
          a: "patience_level",
        },
        { q: "Видишь ли ты продолжение себя в детях?", a: "legacy" },
        {
          q: "Готов(а) ли ты не спать ночами из-за ребенка?",
          a: "sacrifice_sleep",
        },
        {
          q: "Обсуждаешь ли ты тему детей с партнером (если он есть)?",
          a: "partner_kids",
        },
        {
          q: "Мечтаешь ли ты научить своего ребенка чему-то важному для тебя?",
          a: "dream",
        },
        {
          q: "Готов(а) ли ты пожертвовать карьерным ростом ради нескольких лет в декрете?",
          a: "career",
        },
      ];

      const answerOptions = {
        emotion: [
          { text: "Тепло и радость", points: 2 },
          { text: "Любопытство", points: 1 },
          { text: "Легкое беспокойство", points: -1 },
          { text: "Панику", points: -2 },
        ],
        sacrifice: [
          { text: "Легко, это новый этап", points: 2 },
          { text: "Готов(а), но буду скучать", points: 1 },
          { text: "Это будет сложно", points: -1 },
          { text: "Нет, это моя свобода", points: -2 },
        ],
        skills: [
          { text: "Конечно, я мастер на все руки", points: 2 },
          { text: "С инструкцией справлюсь", points: 1 },
          { text: "Скорее вызову мастера", points: -1 },
          { text: "Я и молоток - вещи несовместные", points: -2 },
        ],
        reaction: [
          { text: "Да, это очень мило", points: 2 },
          { text: "Иногда, зависит от настроения", points: 1 },
          { text: "Скорее безразличие", points: -1 },
          { text: "Раздражение", points: -2 },
        ],
        finance: [
          { text: "Да, я финансово готов(а)", points: 2 },
          { text: "Придется пересмотреть бюджет", points: 1 },
          { text: "Это серьезный удар по кошельку", points: -1 },
          { text: "Абсолютно не готов(а)", points: -2 },
        ],
        weekend: [
          { text: "Отличной идеей!", points: 2 },
          { text: "Нормальным вариантом", points: 1 },
          { text: "Пыткой", points: -1 },
          { text: "Худшим кошмаром", points: -2 },
        ],
        patience: [
          { text: "Да, я очень терпеливый(ая)", points: 2 },
          { text: "Стараюсь быть спокойным(ой)", points: 1 },
          { text: "Меня это немного напрягает", points: -1 },
          { text: "Я начинаю нервничать", points: -2 },
        ],
        duty: [
          { text: "Безусловно, это общая обязанность", points: 2 },
          { text: "Если придется, то да", points: 1 },
          { text: "Предпочел(ла) бы избежать этого", points: -1 },
          { text: "Это не моя забота", points: -2 },
        ],
        space: [
          { text: "Да, это создаст уют", points: 2 },
          { text: "Придется привыкнуть", points: 1 },
          { text: "Мой минимализм пострадает", points: -1 },
          { text: "Нет, я ценю порядок", points: -2 },
        ],
        meetings: [
          { text: "Нет, это важная часть родительства", points: 2 },
          { text: "Не очень, но что поделать", points: 1 },
          { text: "Да, звучит уныло", points: -1 },
          { text: "Это мой личный ад", points: -2 },
        ],
        patience_level: [
          { text: "Да, определенно", points: 2 },
          { text: "50/50, зависит от ситуации", points: 1 },
          { text: "Скорее нет, я вспыльчивый(ая)", points: -1 },
          { text: "Точно нет", points: -2 },
        ],
        legacy: [
          { text: "Да, это смысл жизни", points: 2 },
          { text: "Отчасти, это приятно", points: 1 },
          { text: "Не задумывался(ась)", points: 0 },
          { text: "Нет, я живу для себя", points: -2 },
        ],
        sacrifice_sleep: [
          { text: "Да, я готов(а) к этому", points: 2 },
          { text: "Будет тяжело, но я справлюсь", points: 1 },
          { text: "Надеюсь, этого не случится", points: -1 },
          { text: "Нет, сон для меня святое", points: -2 },
        ],
        partner_kids: [
          { text: "Да, мы оба этого хотим", points: 2 },
          { text: "Иногда обсуждаем, но без конкретики", points: 1 },
          { text: "У меня сейчас нет партнера", points: 0 },
          { text: "У нас разные взгляды на это", points: -1 },
        ],
        dream: [
          { text: "Да, это мечта!", points: 2 },
          { text: "Это было бы мило", points: 1 },
          { text: "Не думал(а) об этом", points: 0 },
          { text: "Звучит как большая ответственность", points: -1 },
        ],
        career: [
          { text: "Да, семья важнее", points: 2 },
          { text: "Это сложный выбор, но я готов(а)", points: 1 },
          { text: "Постараюсь совмещать", points: -1 },
          { text: "Нет, карьера на первом месте", points: -2 },
        ],
      };

      const testContainer = document.getElementById("test-container");
      const resultsContainer = document.getElementById("results-container");
      const form = document.getElementById("children-test-form");

      let answeredQuestions = 0;

      // --- Lenis Smooth Scroll Initialization ---
      const lenis = new Lenis({
        lerp: 0.07,
        smoothWheel: true,
      });

      function raf(time) {
        lenis.raf(time);
        requestAnimationFrame(raf);
      }
      requestAnimationFrame(raf);

      function startTest() {
        testContainer.classList.add("fade-in");
        renderQuestions();
      }

      function updateProgress() {
        const progress = (answeredQuestions / questions.length) * 100;
        document.getElementById("progress-fill").style.width = progress + "%";
      }

      function renderQuestions() {
        form.innerHTML = "";
        questions.forEach((qData, index) => {
          const block = document.createElement("div");
          block.className = "question-block fade-in";
          block.style.animationDelay = `${index * 0.05}s`;

          const questionText = document.createElement("p");
          questionText.className = "font-medium text-lg text-gray-100 mb-4";
          questionText.textContent = `${index + 1}. ${qData.q}`;
          block.appendChild(questionText);

          const optionsContainer = document.createElement("div");
          optionsContainer.className =
            "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3";

          const currentAnswerSet = answerOptions[qData.a];

          currentAnswerSet.forEach((opt) => {
            const label = document.createElement("label");
            label.className =
              "option-card p-4 rounded-xl text-center cursor-pointer flex items-center justify-center min-h-[60px]";
            const radio = document.createElement("input");
            radio.type = "radio";
            radio.name = `q${index}`;
            radio.value = opt.points;
            radio.required = true;
            label.appendChild(radio);
            label.append(opt.text);
            optionsContainer.appendChild(label);
          });

          block.appendChild(optionsContainer);
          form.appendChild(block);
        });
      }

      form.addEventListener("change", (e) => {
        if (e.target.type === "radio") {
          const container = e.target.closest(".grid");
          container
            .querySelectorAll(".option-card")
            .forEach((card) => card.classList.remove("selected"));
          e.target.parentElement.classList.add("selected");

          const questionBlock = e.target.closest(".question-block");
          if (!questionBlock.hasAttribute("data-answered")) {
            questionBlock.setAttribute("data-answered", "true");
            answeredQuestions++;
            updateProgress();
          }
        }
      });

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        if (answeredQuestions < questions.length) {
          const unansweredBlock = form.querySelector(
            ".question-block:not([data-answered])"
          );
          if (unansweredBlock) {
            lenis.scrollTo(unansweredBlock, { offset: -150 });
          }
          return;
        }
        const score = calculateScore();
        renderResults(score);
      });

      function calculateScore() {
        const formData = new FormData(form);
        let totalScore = 0;
        for (let i = 0; i < questions.length; i++) {
          const value = formData.get(`q${i}`);
          if (value !== null) {
            totalScore += parseInt(value, 10);
          }
        }
        return totalScore;
      }

      function renderResults(score) {
        testContainer.classList.add("fade-out");
        testContainer.addEventListener(
          "animationend",
          () => {
            testContainer.classList.add("hidden");
            resultsContainer.classList.remove("hidden");
            resultsContainer.classList.add("fade-in");
            lenis.scrollTo(0);
          },
          { once: true }
        );

        const titleEl = document.getElementById("result-title");
        const descriptionEl = document.getElementById("result-description");
        const timelineContainer = document.getElementById("timeline-container");
        timelineContainer.innerHTML = "";

        let resultData;

        if (score > 15) {
          resultData = {
            title: "Большая и дружная семья (3+ ребенка)",
            description:
              "Вы обладаете огромным запасом любви, терпения и энергии. Ваше призвание — быть в центре большой, шумной и веселой семьи. Вас ждут множество счастливых моментов, связанных с детским смехом и топотом маленьких ножек.",
            timeline: [
              { age: "25-28 лет", event: "Серьезные отношения", icon: "💍" },
              { age: "28-30 лет", event: "Первый ребенок", icon: "👶" },
              { age: "31-33 года", event: "Второй ребенок", icon: "👧" },
              { age: "35+ лет", event: "Возможно, и третий!", icon: "👨‍👩‍👧‍👦" },
            ],
          };
        } else if (score > -5) {
          resultData = {
            title: "Золотая середина (1-2 ребенка)",
            description:
              "Вы стремитесь к балансу между родительством и личной реализацией. Ваша семья будет компактной, но от этого не менее счастливой. Качество отношений для вас важнее количества.",
            timeline: [
              { age: "28-33 года", event: "Серьезные отношения", icon: "💍" },
              { age: "30-35 лет", event: "Первый ребенок", icon: "👶" },
              { age: "33-38 лет", event: "Возможно, второй", icon: "🎯" },
              { age: "40+ лет", event: "Гармоничная семья", icon: "✨" },
            ],
          };
        } else {
          resultData = {
            title: "Свобода и саморазвитие (0-1 ребенок)",
            description:
              "На данном этапе жизни вы больше сфокусированы на самореализации, карьере и познании мира. Дети могут не быть вашим главным приоритетом, и это абсолютно нормально. Возможно, вы найдете свое счастье в путешествиях, творчестве или станете прекрасным родителем для пушистого питомца.",
            timeline: [
              { age: "25-35 лет", event: "Карьера и путешествия", icon: "✈️" },
              { age: "35-40 лет", event: "Стабильные отношения", icon: "❤️" },
              { age: "40+ лет", event: "Возможно, один ребенок", icon: "🤔" },
              {
                age: "В любом возрасте",
                event: "Счастье в гармонии с собой",
                icon: "🧘",
              },
            ],
          };
        }

        titleEl.textContent = resultData.title;
        descriptionEl.textContent = resultData.description;

        resultData.timeline.forEach((item, index) => {
          const timelineItem = document.createElement("div");
          timelineItem.className = "timeline-item";
          timelineItem.style.animationDelay = `${index * 0.2}s`;
          timelineItem.innerHTML = `
                <div class="text-5xl mb-4">${item.icon}</div>
                <h4 class="font-bold text-lg">${item.age}</h4>
                <p class="text-gray-400">${item.event}</p>
            `;
          timelineContainer.appendChild(timelineItem);
        });
      }

      document.addEventListener("DOMContentLoaded", startTest);
    </script>
  </body>
</html>
